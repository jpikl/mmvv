# rew

Rew is a CLI tool that rewrites FS paths according to a pattern.

[![Build status][build-img]][build]
[![Code coverage][coverage-img]][coverage]

:construction: Work in progress... :construction:

## Contents

- [:bulb: What rew does](#bulb-what-rew-does)
- [:inbox_tray: Input](#inbox_tray-input)
- [:pencil: Pattern](#pencil-pattern)
- [:outbox_tray: Output](#outbox_tray-output)

## :bulb: What rew does

1. Reads values from standard input.
2. Rewrites them using provided pattern.
3. Prints results to standard output.

Input values are assumed to be FS paths, however, `rew` is able to process any UTF-8 encoded text.

```text
+------------+       +-------------------+       +-----------+
| STDIN      |  -->  | PATTERN           |  -->  | STDOUT    |
+------------+       +-------------------+       +-----------+
| photo.PNG  |       | img_{C}.{e|l|r:e} |       | img_1.png |
| image.jpeg |       +-------------------+       | img_2.jpg |
| logo.gif   |                                   | img_3.gif |
+------------+                                   +-----------+
```

[build]: https://travis-ci.com/github/jpikl/rew
[build-img]: https://travis-ci.com/jpikl/rew.svg?branch=master
[coverage]: https://codecov.io/gh/jpikl/rew
[coverage-img]: https://codecov.io/gh/jpikl/rew/branch/master/graph/badge.svg

## :inbox_tray: Input

By default, paths are read as lines from standard input.

```bash
find | rew '{f}' # Process paths generated by find command
```

Use `-z, --read-nul` flag to read paths separated by NUL character.

```bash
find -print0 | rew -z '{f}' # When paths contain newlines
```

Use `-r, --read-raw` flag to read whole input as a single value.

```bash
rew -r '{f}' < data.bin # Process file content as a whole
```

Input paths can be also provided as additional arguments.

```bash
rew '{f}' *.txt # Wildcard expansion done by shell
```

## :pencil: Pattern

TODO

## :outbox_tray: Output

By default, results are printed as lines to standard output.

```bash
rew '{f}' | xargs echo # Pass generated paths to echo command
```

Use `-Z, --print-nul` flag to print results separated by NUL character.

```bash
rew -Z '{f}' | xargs -0 echo # When paths contain newlines
```

Use `-R, --print-raw` to print results without any delimiter.

```bash
rew -r '{f};' # Use semicolon as our own delimiter
```

Use `-p, --pretty` to print nicely formatted transformations.

```bash
rew -p '{f}' # Formatted as "src_path -> dst_path"
```

Use `-b, --bulk` to print transformations in the following format.

```text
<src_path_1
>dst_path_1
<src_path_2
>dst_path_2
...
<src_path_N
>dst_path_N
```

Such output can be processed by accompanying `mvb`  and `cpb` utilities to perform bulk move/rename of files and directories.

```bash
rew -b '{p}.bak' | cpb # Make backup copy of each file
```

The previous example can be also achieved using standard `cp` command in less efficient way.

```bash
rew 'cp "{p}" "{p}.bak"' | sh # Generate code and execute it
```
